<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Day Counter (EST)</title>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <!-- <script src="script.js"></script> -->
  </head>
  <body>
    <div class="container">
      <h1>E&J Day Counter (EST)</h1>
      <div id="dating">
        <p>since the first kiss</p>
        <h1 id="day-dating">0</h1>
      </div>
      <div id="springsem">
        <p>until the start of NOVA, Spring 2025 Semester</p>
        <h1 id="day-springsem">0</h1>
      </div>
      <div id="graduation">
        <p>until NOVA Graduation</p>
        <h1 id="day-graduation-nova">0</h1>
      </div>
      <div id="mason">
        <p>until the start of Mason, Fall 2025 Semester</p>
        <h1 id="day-mason">0</h1>
      </div>
      <div id="graduation">
        <p>until Mason Graduation</p>
        <h1 id="day-graduation-mason">0</h1>
      </div>

      <div class="container specific">
        <div id="specific">
          <p id="day-specific-text">until a specific date</p>
          <h1 id="day-specific">0</h1>
          <input type="date" id="specific-date" />
        </div>
      </div>
    </div>
  </body>
  <script>
    function calculateDays() {
      const startDating = convertToEST(new Date("2024-01-21T00:00:00"));
      const endDateSpring = convertToEST(new Date("2025-01-21T00:00:00"));
      const endDateMason = convertToEST(new Date("2025-08-26T00:00:00"));
      const endDateMasonGraduation = convertToEST(
        new Date("2027-05-15T00:00:00")
      );
      const endDateNOVAGraduation = convertToEST(
        new Date("2025-05-12T00:00:00")
      );
      const input = document.getElementById("specific-date");

      setInterval(() => {
        const currentDate = getCurrentESTTime();
        updateCounter(startDating, "day-dating", null, currentDate);
        updateCounter(endDateSpring, "day-springsem", null, currentDate);
        updateCounter(endDateMason, "day-mason", null, currentDate);
        updateCounter(
          endDateMasonGraduation,
          "day-graduation-mason",
          null,
          currentDate
        );
        updateCounter(
          endDateNOVAGraduation,
          "day-graduation-nova",
          null,
          currentDate
        );
      }, 1000);

      let specificInterval;

      input.addEventListener("change", () => {
        if (specificInterval) clearInterval(specificInterval);

        const endDate = convertToEST(new Date(input.value + "T00:00:00"));

        specificInterval = setInterval(() => {
          const currentDate = getCurrentESTTime();
          updateCounter(
            endDate,
            "day-specific",
            "day-specific-text",
            currentDate
          );
        }, 1000);
      });
    }

    function getCurrentESTTime() {
      const now = new Date();
      return new Date(
        now.toLocaleString("en-US", { timeZone: "America/New_York" })
      );
    }

    function convertToEST(date) {
      return new Date(
        date.toLocaleString("en-US", { timeZone: "America/New_York" })
      );
    }

    function updateCounter(endDate, dayElementId, textElementId, currentDate) {
      const timeDifference = endDate - currentDate;
      const daysDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24));
      const hoursDifference = Math.floor(
        (timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
      );
      const minutesDifference = Math.floor(
        (timeDifference % (1000 * 60 * 60)) / (1000 * 60)
      );
      const secondsDifference = Math.floor(
        (timeDifference % (1000 * 60)) / 1000
      );
      document.getElementById(dayElementId).textContent = `${Math.abs(
        daysDifference
      )} d ${Math.abs(hoursDifference)} h ${Math.abs(
        minutesDifference
      )} m ${Math.abs(secondsDifference)} s`;

      if (textElementId) {
        const prefix = timeDifference < 0 ? "from" : "until";
        document.getElementById(textElementId).textContent = `${prefix} ${
          endDate.toISOString().split("T")[0]
        }`;
      }
    }

    calculateDays();
  </script>
</html>
