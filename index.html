<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Day Counter (EST)</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2em;
        margin: 0;
        background-color: #f0f0f0;
      }
      #springsem,
      #specific,
      #mason,
      #graduation {
        text-align: center;
        padding: 2em;
        border: 3px solid black;
        border-radius: 10px;
        margin: 2em;
      }
      #springsem h1,
      #specific h1,
      #mason h1,
      #graduation h1 {
        font-size: 3em;
        margin: 0;
      }
      .container {
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container springsem">
      <h1>Day Counter (EST)</h1>

      <div id="springsem">
        <h1 id="day-springsem">0</h1>
        <p>Days until the start of NOVA, Spring 2025 Semester</p>
      </div>
      <div id="graduation">
        <h1 id="day-graduation-nova">0</h1>
        <p>Days until NOVA Graduation</p>
      </div>
      <div id="mason">
        <h1 id="day-mason">0</h1>
        <p>Days until the start of Mason, Fall 2025 Semester</p>
      </div>
      <div id="graduation">
        <h1 id="day-graduation-mason">0</h1>
        <p>Days until Mason Graduation</p>
      </div>

      <div class="container specific">
        <div id="specific">
          <h1 id="day-specific">0</h1>
          <p id="day-specific-text">Days until a specific date</p>
          <input type="date" id="specific-date" />
        </div>
      </div>
    </div>

    <script>
      function calculateDays() {
        const endDateSpring = convertToEST(new Date("2025-01-21T00:00:00"));
        const endDateMason = convertToEST(new Date("2025-08-26T00:00:00"));
        const endDateMasonGraduation = convertToEST(
          new Date("2027-05-15T00:00:00")
        );
        const endDateNOVAGraduation = convertToEST(
          new Date("2025-05-12T00:00:00")
        );
        const input = document.getElementById("specific-date");

        setInterval(() => {
          const currentDate = getCurrentESTTime();
          updateCounter(endDateSpring, "day-springsem", null, currentDate);
          updateCounter(endDateMason, "day-mason", null, currentDate);
          updateCounter(
            endDateMasonGraduation,
            "day-graduation-mason",
            null,
            currentDate
          );
          updateCounter(
            endDateNOVAGraduation,
            "day-graduation-nova",
            null,
            currentDate
          );
        }, 1000);

        let specificInterval;

        input.addEventListener("change", () => {
          if (specificInterval) clearInterval(specificInterval);

          const endDate = convertToEST(new Date(input.value + "T00:00:00"));

          specificInterval = setInterval(() => {
            const currentDate = getCurrentESTTime();
            updateCounter(
              endDate,
              "day-specific",
              "day-specific-text",
              currentDate
            );
          }, 1000);
        });
      }

      function getCurrentESTTime() {
        const now = new Date();
        return new Date(
          now.toLocaleString("en-US", { timeZone: "America/New_York" })
        );
      }

      function convertToEST(date) {
        return new Date(
          date.toLocaleString("en-US", { timeZone: "America/New_York" })
        );
      }

      function updateCounter(
        endDate,
        dayElementId,
        textElementId,
        currentDate
      ) {
        const timeDifference = endDate - currentDate;
        const daysDifference = Math.floor(
          timeDifference / (1000 * 60 * 60 * 24)
        );
        const hoursDifference = Math.floor(
          (timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
        );
        const minutesDifference = Math.floor(
          (timeDifference % (1000 * 60 * 60)) / (1000 * 60)
        );
        const secondsDifference = Math.floor(
          (timeDifference % (1000 * 60)) / 1000
        );
        document.getElementById(
          dayElementId
        ).textContent = `${daysDifference} d ${hoursDifference} h ${minutesDifference} m ${secondsDifference} s`;

        if (textElementId) {
          const prefix = timeDifference < 0 ? "Days from" : "Days until";
          document.getElementById(textElementId).textContent = `${prefix} ${
            endDate.toISOString().split("T")[0]
          }`;
        }
      }

      calculateDays();
    </script>
  </body>
</html>
